<!DOCTYPE html>
<html>
<head>
  
  <title>East or West Berlin?</title>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" ></script>


  <style>
    html, body {
      height: 100%;
      margin: 0;
    }
    #map {
      width: 600px;
      height: 400px;
    }

    /* pulsing icon */
    .leaflet-pulsing-icon {
      border-radius: 100%;
      box-shadow: 1px 1px 8px 0 rgba(0,0,0,0.75);
    }

    .leaflet-pulsing-icon:after {
      content: "";
      -webkit-border-radius: 100%;
      border-radius: 100%;
      height: 300%;
      width: 300%;
      position: absolute;
      margin: -100% 0 0 -100%;
      }

    @keyframes pulsate {
      0% {
        transform: scale(0.1, 0.1);
        opacity: 0;
        -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";
        filter: alpha(opacity=0);
      }
      50% {
        opacity: 1;
        -ms-filter: none;
        filter: none;
      }
      100% {
        transform: scale(1.2, 1.2);
        opacity: 0;
        -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";
        filter: alpha(opacity=0);
      }
    }
  </style>

  <style>body { padding: 0; margin: 0; } #map { height: 100%; width: 100vw; }</style>
</head>
<body>

<div id='map'></div>

<script type="text/javascript">
  /* from https://github.com/mapshakers/leaflet-icon-pulse */
  (function(window) {

    L.Icon.Pulse = L.DivIcon.extend({

        options: {
            className: '',
            iconSize: [12,12],
            fillColor: 'red',
            color: 'red',
            animate: true,
            heartbeat: 1,
        },

        initialize: function (options) {
            L.setOptions(this,options);

            // css
            
            var uniqueClassName = 'lpi-'+ new Date().getTime()+'-'+Math.round(Math.random()*100000);

            var before = ['background-color: '+this.options.fillColor];
            var after = [

                'box-shadow: 0 0 6px 2px '+this.options.color,

                'animation: pulsate ' + this.options.heartbeat + 's ease-out',
                'animation-iteration-count: infinite',
                'animation-delay: '+ (this.options.heartbeat + .1) + 's',
            ];

            if (!this.options.animate){
                after.push('animation: none');
                after.push('box-shadow:none');
            }

            var css = [
                '.'+uniqueClassName+'{'+before.join(';')+';}',
                '.'+uniqueClassName+':after{'+after.join(';')+';}',
            ].join('');
 
            var el = document.createElement('style');
            if (el.styleSheet){
                el.styleSheet.cssText = css;
            } else {
                el.appendChild(document.createTextNode(css));
            }

            document.getElementsByTagName('head')[0].appendChild(el);

            // apply css class

            this.options.className = this.options.className+' leaflet-pulsing-icon '+uniqueClassName;

            // initialize icon
            
            L.DivIcon.prototype.initialize.call(this, options);
        
        }
    });

    L.icon.pulse = function (options) {
        return new L.Icon.Pulse(options);
    };


    L.Marker.Pulse = L.Marker.extend({
        initialize: function (latlng,options) {
            options.icon = L.icon.pulse(options);
            L.Marker.prototype.initialize.call(this, latlng, options);
        }
    });

    L.marker.pulse = function (latlng,options) {
        return new L.Marker.Pulse(latlng,options);
    };

})(window);
</script>

<script>
  // set max bounds 
  var northWest = L.latLng(52.785, 12.941);
  var southEast = L.latLng(52.200, 13.972);
  bounds = L.latLngBounds(northWest, southEast);

  // create map
  var map = L.map('map', {maxBounds: bounds, zoomControl: false}).setView([52.512782,13.4157815], 13);
  if (!navigator.geolocation){
    alert('no geolocation :(');
  }

  // clean white background 
  var latlngs = [[53.000, 12.000],[53.000, 14.000],[52.000, 14.000],[52.000, 12.000]]; 
  var polygon = L.polygon(latlngs, {color: 'white',
                                    fillColor: 'white',
                                    fillOpacity: 1,
                }).addTo(map);

  // draw Berlin Wall 
  const berlinWall = {"type":"FeatureCollection","features":[{"type":"Feature","properties":{"stroke":"#000000","stroke-opacity":1,"stroke-width":3},"geometry":{"type":"LineString","coordinates":[[13.159061,52.380251],[13.158631,52.380985],[13.156142,52.383866],[13.166528,52.384705],[13.16627,52.383762],[13.167129,52.382242],[13.163095,52.381823],[13.163781,52.381037],[13.159404,52.380094]],"bbox":[13.156142,52.380094,13.167129,52.384705]},"bbox":[13.156142,52.380094,13.167129,52.384705]},{"type":"Feature","properties":{"stroke":"#000000","stroke-opacity":1,"stroke-width":3},"geometry":{"type":"LineString","coordinates":[[13.516043,52.401794],[13.516032,52.402147],[13.517062,52.402815],[13.51674,52.403319],[13.519294,52.404949],[13.519019,52.40514],[13.52183,52.407366],[13.522388,52.408439],[13.523279,52.410776],[13.522903,52.411011],[13.523429,52.411679],[13.522978,52.412091],[13.523397,52.412418],[13.523193,52.412647],[13.523679,52.413186],[13.524108,52.413592],[13.52267,52.414298],[13.522338,52.414554],[13.522939,52.415463],[13.522102,52.41704],[13.522198,52.41721],[13.52222,52.418283],[13.52208,52.418283],[13.522059,52.418447],[13.520782,52.419592],[13.52046,52.42079],[13.519924,52.421274],[13.519505,52.421391],[13.519194,52.42164],[13.519291,52.421719],[13.518754,52.422249],[13.520203,52.426024],[13.520417,52.426069],[13.520417,52.426527],[13.519924,52.426717],[13.51574,52.427044],[13.513015,52.427424],[13.51074,52.427895],[13.508605,52.428588],[13.508455,52.428542],[13.507425,52.428919],[13.504743,52.430188],[13.499335,52.432791],[13.488889,52.437891],[13.472195,52.445896],[13.465414,52.449244],[13.462324,52.45186],[13.457045,52.459261],[13.475199,52.458738],[13.475628,52.459914],[13.476486,52.461379],[13.478031,52.462895],[13.478889,52.46436],[13.478804,52.464882],[13.475542,52.468124],[13.470735,52.472464],[13.470006,52.473484],[13.469791,52.474477],[13.470907,52.477013],[13.458204,52.485742],[13.456144,52.484174],[13.446785,52.488994],[13.444267,52.487263],[13.440062,52.489419],[13.439629,52.489667],[13.439726,52.490372],[13.440359,52.490862],[13.441121,52.491391],[13.44258,52.492535],[13.445501,52.494836],[13.44696,52.494836],[13.447518,52.494862],[13.450651,52.497057],[13.451345,52.497381],[13.452182,52.497532],[13.452955,52.497682],[13.452711,52.497866],[13.45274,52.498217],[13.452239,52.49848],[13.452046,52.49848],[13.451424,52.498951],[13.450651,52.498912],[13.450415,52.49899],[13.450308,52.499264],[13.44681,52.500388],[13.444897,52.501219],[13.444071,52.501635],[13.44302,52.502183],[13.441453,52.502928],[13.438428,52.504038],[13.437269,52.504534],[13.434501,52.50605],[13.433943,52.506402],[13.431626,52.507565],[13.429158,52.508871],[13.428429,52.508113],[13.428163,52.506997],[13.427477,52.506056],[13.424387,52.505011],[13.421597,52.505129],[13.419403,52.505724],[13.418984,52.505186],[13.418056,52.504984],[13.417606,52.504161],[13.414907,52.504893],[13.414623,52.504788],[13.414639,52.504687],[13.414087,52.50404],[13.411517,52.504879],[13.409977,52.506917],[13.408041,52.506169],[13.405284,52.508203],[13.404758,52.507975],[13.404436,52.507776],[13.402843,52.508504],[13.400193,52.509382],[13.399222,52.508053],[13.398771,52.508102],[13.388965,52.507505],[13.386047,52.507338],[13.378939,52.506981],[13.377826,52.507934],[13.376874,52.508141],[13.376592,52.508949],[13.376472,52.509567],[13.376762,52.511389],[13.376823,52.51163],[13.376885,52.511872],[13.377008,52.512355],[13.376826,52.512466],[13.376992,52.513608],[13.377159,52.514569],[13.377292,52.515241],[13.377314,52.515645],[13.376898,52.515784],[13.376651,52.515986],[13.376544,52.516208],[13.376683,52.516489],[13.376994,52.516698],[13.377338,52.516842],[13.376855,52.517723],[13.376994,52.517951],[13.377005,52.519544],[13.37663,52.519747],[13.376308,52.520041],[13.376136,52.520328],[13.376093,52.520641],[13.375932,52.521222],[13.37546,52.521731],[13.374945,52.522084],[13.374344,52.522365],[13.373733,52.52258],[13.373046,52.522724],[13.371791,52.522789],[13.371812,52.525361],[13.371018,52.525374],[13.371018,52.526503],[13.3734,52.526484],[13.373888,52.526842],[13.373803,52.527599],[13.373459,52.528082],[13.371271,52.530053],[13.369431,52.53241],[13.369023,52.532775],[13.368508,52.533278],[13.368315,52.533298],[13.365922,52.535621],[13.368009,52.536527],[13.368615,52.535973],[13.373052,52.538015],[13.374516,52.537044],[13.3756,52.53769],[13.376608,52.538375],[13.379526,52.540143],[13.379784,52.54015],[13.380084,52.539752],[13.381522,52.538362],[13.383528,52.536593],[13.387444,52.533467],[13.3883,52.533606],[13.390295,52.535375],[13.393342,52.537287],[13.396121,52.538109],[13.403535,52.54023],[13.400324,52.546481],[13.399235,52.549115],[13.398881,52.550876],[13.396853,52.550713],[13.397669,52.551346],[13.398055,52.552155],[13.398152,52.552885],[13.397728,52.554146],[13.397218,52.556307],[13.397175,52.558221],[13.397004,52.558567],[13.397014,52.559043],[13.39665,52.560002],[13.396337,52.561142],[13.39562,52.562141],[13.394767,52.563121],[13.393399,52.564365],[13.391788,52.565355],[13.388072,52.567451],[13.389917,52.568599],[13.383051,52.572381],[13.382235,52.57199],[13.379403,52.57259],[13.364211,52.581222],[13.34756,52.590124],[13.35331,52.59087],[13.360606,52.591193],[13.370949,52.599509],[13.376399,52.607693],[13.376399,52.611445],[13.375111,52.614677],[13.366657,52.625437]],"bbox":[13.34756,52.401794,13.524108,52.625437]},"bbox":[13.34756,52.401794,13.524108,52.625437]},{"type":"Feature","properties":{"stroke":"#000000","stroke-opacity":1,"stroke-width":3},"geometry":{"type":"LineString","coordinates":[[13.046897,52.599408],[13.043378,52.601389],[13.040889,52.603683],[13.049987,52.607801],[13.056853,52.604778],[13.047155,52.599461]],"bbox":[13.040889,52.599408,13.056853,52.607801]},"bbox":[13.040889,52.599408,13.056853,52.607801]},{"type":"Feature","properties":{"stroke":"#000000","stroke-opacity":1,"stroke-width":3},"geometry":{"type":"LineString","coordinates":[[13.516064,52.401781],[13.51505,52.401329],[13.511745,52.400674],[13.481009,52.396763],[13.466933,52.420429],[13.4635,52.421371],[13.454745,52.419068],[13.435124,52.413084],[13.418954,52.41022],[13.418525,52.406225],[13.421357,52.400465],[13.42685,52.387979],[13.427708,52.385815],[13.420756,52.376078],[13.388398,52.377912],[13.388226,52.382575],[13.387068,52.388571],[13.377927,52.38818],[13.370502,52.388518],[13.372391,52.39339],[13.356512,52.399779],[13.342693,52.407739],[13.342865,52.411718],[13.31497,52.401036],[13.313917,52.400523],[13.312052,52.399203],[13.305484,52.405694],[13.29866,52.411899],[13.296021,52.414451],[13.296708,52.414713],[13.297051,52.41521],[13.297115,52.415746],[13.296815,52.416283],[13.29115,52.413404],[13.285206,52.409974],[13.280379,52.407357],[13.275915,52.40517],[13.273083,52.40445],[13.270166,52.404107],[13.266474,52.404293],[13.264457,52.404725],[13.261024,52.40593],[13.259775,52.406217],[13.257865,52.406387],[13.255784,52.406322],[13.253488,52.40606],[13.251278,52.405536],[13.249797,52.405013],[13.249346,52.407068],[13.249025,52.408377],[13.24911,52.411728],[13.247029,52.419175],[13.245876,52.421122],[13.231371,52.419866],[13.223818,52.420704],[13.218153,52.419447],[13.204592,52.415469],[13.197468,52.415573],[13.159144,52.402845],[13.159488,52.399808],[13.158071,52.398059],[13.158028,52.396299],[13.17118,52.397663],[13.17159,52.395671],[13.169935,52.394795],[13.166268,52.394204],[13.158887,52.393995],[13.145861,52.395468],[13.144638,52.39573],[13.143329,52.396358],[13.143136,52.397248],[13.142192,52.397104],[13.140089,52.396184],[13.134231,52.393225],[13.130361,52.390437],[13.131262,52.3899],[13.133172,52.3888],[13.134052,52.388774],[13.133322,52.38732],[13.131713,52.387438],[13.131091,52.387202],[13.126936,52.389515],[13.127387,52.391623],[13.131078,52.391689],[13.138588,52.396075],[13.135517,52.396321],[13.135174,52.397316],[13.138049,52.397761],[13.133309,52.399179],[13.127301,52.396037],[13.111142,52.405091],[13.107388,52.408396],[13.110478,52.409757],[13.111852,52.411642],[13.107732,52.413631],[13.106015,52.409757],[13.10138,52.410184],[13.10035,52.414364],[13.096402,52.413422],[13.098977,52.410595],[13.097089,52.409548],[13.090737,52.411432],[13.090242,52.413732],[13.088396,52.41949],[13.09625,52.421767],[13.098996,52.424803],[13.100155,52.425352],[13.104813,52.423996],[13.113311,52.42934],[13.111937,52.431956],[13.122903,52.438907],[13.12361,52.439073],[13.120864,52.441479],[13.109019,52.451001],[13.111508,52.453493],[13.112452,52.458619],[13.110392,52.46024],[13.110736,52.466358],[13.116916,52.472685],[13.118718,52.479325],[13.127988,52.478697],[13.147385,52.494482],[13.168156,52.509007],[13.142236,52.519976],[13.144366,52.528406],[13.140504,52.530442],[13.142221,52.533209],[13.142135,52.536185],[13.143165,52.541092],[13.144023,52.546208],[13.143594,52.548452],[13.141448,52.552106],[13.144557,52.552159],[13.14739,52.554455],[13.146188,52.560404],[13.148072,52.565199],[13.152621,52.570572],[13.153398,52.576472],[13.148587,52.588149],[13.144124,52.589192],[13.135283,52.587179],[13.139403,52.585093],[13.145583,52.585719],[13.144639,52.581964],[13.138545,52.580556],[13.13288,52.579461],[13.130477,52.583164],[13.128056,52.583239],[13.129516,52.587411],[13.136399,52.589487],[13.147673,52.591204],[13.151119,52.593285],[13.154939,52.596578],[13.156054,52.60259],[13.167041,52.603633],[13.170731,52.597412],[13.205991,52.587255],[13.218007,52.58715],[13.21938,52.592573],[13.207364,52.599038],[13.200257,52.605752],[13.208222,52.610402],[13.217492,52.620303],[13.220582,52.628119],[13.263429,52.627848],[13.26566,52.634403],[13.262055,52.640445],[13.273969,52.639787],[13.284612,52.641662],[13.282208,52.652598],[13.282826,52.660675],[13.306584,52.659574],[13.309906,52.657354],[13.30055,52.653553],[13.309563,52.643555],[13.306902,52.639544],[13.307202,52.637633],[13.305829,52.637216],[13.310078,52.632564],[13.310421,52.62923],[13.303125,52.627772],[13.302696,52.627251],[13.312507,52.628197],[13.319802,52.626608],[13.328299,52.625514],[13.336086,52.622632],[13.342395,52.623544],[13.366511,52.625404]],"bbox":[13.088396,52.376078,13.516064,52.660675]},"bbox":[13.088396,52.376078,13.516064,52.660675]}],"bbox":[13.040889,52.376078,13.524108,52.660675]}
  const berlinWallStyle = {color: "#000000", weight: 3,}
  L.geoJSON(berlinWall, {style: berlinWallStyle}).addTo(map); 

  // draw map limits
  const berlinNE = L.latLng(52.673, 13.072);
  const berlinSW = L.latLng(52.349, 13.763);
  berlinBounds = L.latLngBounds(berlinNE, berlinSW);
  map.fitBounds(berlinBounds);

  function onLocationFound(e) {
    var pulsingIcon = L.icon.pulse({iconSize:[20,20],color:'red'});
    var marker = L.marker(e.latlng,{icon: pulsingIcon}).addTo(map);
  }

  function onLocationError(e) {
    alert("You need to allow location access in order for this to work...");
  }


  map.on('locationfound', onLocationFound);
  map.on('locationerror', onLocationError);

  map.locate({setView: true, maxZoom: 16});
  
</script>



</body>
</html>
